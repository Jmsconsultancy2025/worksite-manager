{"dependencies":[{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":100},"end":{"line":4,"column":69,"index":169}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  exports.loadWorkers = loadWorkers;\n  exports.saveWorkers = saveWorkers;\n  exports.updateAttendance = updateAttendance;\n  exports.updateSalary = updateSalary;\n  exports.isExpired = isExpired;\n  exports.getUserSubscription = getUserSubscription;\n  exports.setUserSubscription = setUserSubscription;\n  Object.defineProperty(exports, \"PLAN_LIMITS\", {\n    enumerable: true,\n    get: function () {\n      return PLAN_LIMITS;\n    }\n  });\n  var _reactNativeAsyncStorageAsyncStorage = require(_dependencyMap[0], \"@react-native-async-storage/async-storage\");\n  var AsyncStorage = _interopDefault(_reactNativeAsyncStorageAsyncStorage);\n  // localStorage helper functions for worker data\n  // Note: Using localStorage for web compatibility\n\n  const WORKERS_KEY = 'worksite_workers';\n  const SUBSCRIPTION_KEY = '@currentSubscription';\n  async function loadWorkers() {\n    try {\n      const data = await AsyncStorage.default.getItem(WORKERS_KEY);\n      return data ? JSON.parse(data) : {};\n    } catch (error) {\n      console.error('Error loading workers:', error);\n      return {};\n    }\n  }\n  async function saveWorkers(workers) {\n    try {\n      await AsyncStorage.default.setItem(WORKERS_KEY, JSON.stringify(workers));\n      return true;\n    } catch (error) {\n      console.error('Error saving workers:', error);\n      return false;\n    }\n  }\n  async function updateAttendance(workerId, dateISO, status) {\n    const workers = await loadWorkers();\n    if (!workers[workerId]) {\n      workers[workerId] = {\n        attendance: []\n      };\n    }\n    if (!workers[workerId].attendance) {\n      workers[workerId].attendance = [];\n    }\n\n    // Find existing or create new\n    const existingIndex = workers[workerId].attendance.findIndex(a => a.date === dateISO);\n    const record = {\n      date: dateISO,\n      status: status,\n      markedAt: Date.now()\n    };\n    if (existingIndex >= 0) {\n      workers[workerId].attendance[existingIndex] = record;\n    } else {\n      workers[workerId].attendance.push(record);\n    }\n    await saveWorkers(workers);\n    return workers[workerId];\n  }\n  async function updateSalary(workerId, dateISO, amount) {\n    const workers = await loadWorkers();\n    if (!workers[workerId]) {\n      workers[workerId] = {\n        salary: []\n      };\n    }\n    if (!workers[workerId].salary) {\n      workers[workerId].salary = [];\n    }\n\n    // Find existing or create new\n    const existingIndex = workers[workerId].salary.findIndex(s => s.date === dateISO);\n    const record = {\n      date: dateISO,\n      amount: amount,\n      recordedAt: Date.now()\n    };\n    if (existingIndex >= 0) {\n      workers[workerId].salary[existingIndex] = record;\n    } else {\n      workers[workerId].salary.push(record);\n    }\n    await saveWorkers(workers);\n    return workers[workerId];\n  }\n  function isExpired(markedAt) {\n    if (!markedAt) return false;\n    const now = Date.now();\n    const elapsed = now - markedAt;\n    const twentyFourHours = 24 * 60 * 60 * 1000;\n    return elapsed > twentyFourHours;\n  }\n  async function getUserSubscription() {\n    try {\n      const raw = await AsyncStorage.default.getItem(SUBSCRIPTION_KEY);\n      return raw ? JSON.parse(raw) : {\n        plan: 'basic',\n        status: 'active'\n      };\n    } catch (e) {\n      return {\n        plan: 'basic',\n        status: 'active'\n      };\n    }\n  }\n  async function setUserSubscription(subscription) {\n    try {\n      await AsyncStorage.default.setItem(SUBSCRIPTION_KEY, JSON.stringify(subscription));\n      return true;\n    } catch (e) {\n      console.error('Error saving subscription:', e);\n      return false;\n    }\n  }\n  const PLAN_LIMITS = {\n    basic: {\n      workers: 5,\n      sites: 3,\n      reports: 10,\n      features: ['basic_attendance']\n    },\n    premium: {\n      workers: 50,\n      sites: 20,\n      reports: 100,\n      features: ['advanced_attendance', 'salary_management', 'detailed_reports']\n    },\n    enterprise: {\n      workers: 200,\n      sites: 100,\n      reports: 1000,\n      features: ['all_features']\n    }\n  };\n});","lineCount":152,"map":[[12,2,9,0,"exports"],[12,9,9,0],[12,10,9,0,"loadWorkers"],[12,21,9,0],[12,24,9,0,"loadWorkers"],[12,35,9,0],[13,2,19,0,"exports"],[13,9,19,0],[13,10,19,0,"saveWorkers"],[13,21,19,0],[13,24,19,0,"saveWorkers"],[13,35,19,0],[14,2,29,0,"exports"],[14,9,29,0],[14,10,29,0,"updateAttendance"],[14,26,29,0],[14,29,29,0,"updateAttendance"],[14,45,29,0],[15,2,59,0,"exports"],[15,9,59,0],[15,10,59,0,"updateSalary"],[15,22,59,0],[15,25,59,0,"updateSalary"],[15,37,59,0],[16,2,89,0,"exports"],[16,9,89,0],[16,10,89,0,"isExpired"],[16,19,89,0],[16,22,89,0,"isExpired"],[16,31,89,0],[17,2,97,0,"exports"],[17,9,97,0],[17,10,97,0,"getUserSubscription"],[17,29,97,0],[17,32,97,0,"getUserSubscription"],[17,51,97,0],[18,2,106,0,"exports"],[18,9,106,0],[18,10,106,0,"setUserSubscription"],[18,29,106,0],[18,32,106,0,"setUserSubscription"],[18,51,106,0],[19,2,116,0,"Object"],[19,8,116,0],[19,9,116,0,"defineProperty"],[19,23,116,0],[19,24,116,0,"exports"],[19,31,116,0],[20,4,116,0,"enumerable"],[20,14,116,0],[21,4,116,0,"get"],[21,7,116,0],[21,18,116,0,"get"],[21,19,116,0],[22,6,116,0],[22,13,116,0,"PLAN_LIMITS"],[22,24,116,0],[23,4,116,0],[24,2,116,0],[25,2,4,0],[25,6,4,0,"_reactNativeAsyncStorageAsyncStorage"],[25,42,4,0],[25,45,4,0,"require"],[25,52,4,0],[25,53,4,0,"_dependencyMap"],[25,67,4,0],[26,2,4,0],[26,6,4,0,"AsyncStorage"],[26,18,4,0],[26,21,4,0,"_interopDefault"],[26,36,4,0],[26,37,4,0,"_reactNativeAsyncStorageAsyncStorage"],[26,73,4,0],[27,2,1,0],[28,2,2,0],[30,2,6,0],[30,8,6,6,"WORKERS_KEY"],[30,19,6,17],[30,22,6,20],[30,40,6,38],[31,2,7,0],[31,8,7,6,"SUBSCRIPTION_KEY"],[31,24,7,22],[31,27,7,25],[31,49,7,47],[32,2,9,7],[32,17,9,22,"loadWorkers"],[32,28,9,33,"loadWorkers"],[32,29,9,33],[32,31,9,36],[33,4,10,2],[33,8,10,6],[34,6,11,4],[34,12,11,10,"data"],[34,16,11,14],[34,19,11,17],[34,25,11,23,"AsyncStorage"],[34,37,11,35],[34,38,11,35,"default"],[34,45,11,35],[34,46,11,36,"getItem"],[34,53,11,43],[34,54,11,44,"WORKERS_KEY"],[34,65,11,55],[34,66,11,56],[35,6,12,4],[35,13,12,11,"data"],[35,17,12,15],[35,20,12,18,"JSON"],[35,24,12,22],[35,25,12,23,"parse"],[35,30,12,28],[35,31,12,29,"data"],[35,35,12,33],[35,36,12,34],[35,39,12,37],[35,40,12,38],[35,41,12,39],[36,4,13,2],[36,5,13,3],[36,6,13,4],[36,13,13,11,"error"],[36,18,13,16],[36,20,13,18],[37,6,14,4,"console"],[37,13,14,11],[37,14,14,12,"error"],[37,19,14,17],[37,20,14,18],[37,44,14,42],[37,46,14,44,"error"],[37,51,14,49],[37,52,14,50],[38,6,15,4],[38,13,15,11],[38,14,15,12],[38,15,15,13],[39,4,16,2],[40,2,17,0],[41,2,19,7],[41,17,19,22,"saveWorkers"],[41,28,19,33,"saveWorkers"],[41,29,19,34,"workers"],[41,36,19,41],[41,38,19,43],[42,4,20,2],[42,8,20,6],[43,6,21,4],[43,12,21,10,"AsyncStorage"],[43,24,21,22],[43,25,21,22,"default"],[43,32,21,22],[43,33,21,23,"setItem"],[43,40,21,30],[43,41,21,31,"WORKERS_KEY"],[43,52,21,42],[43,54,21,44,"JSON"],[43,58,21,48],[43,59,21,49,"stringify"],[43,68,21,58],[43,69,21,59,"workers"],[43,76,21,66],[43,77,21,67],[43,78,21,68],[44,6,22,4],[44,13,22,11],[44,17,22,15],[45,4,23,2],[45,5,23,3],[45,6,23,4],[45,13,23,11,"error"],[45,18,23,16],[45,20,23,18],[46,6,24,4,"console"],[46,13,24,11],[46,14,24,12,"error"],[46,19,24,17],[46,20,24,18],[46,43,24,41],[46,45,24,43,"error"],[46,50,24,48],[46,51,24,49],[47,6,25,4],[47,13,25,11],[47,18,25,16],[48,4,26,2],[49,2,27,0],[50,2,29,7],[50,17,29,22,"updateAttendance"],[50,33,29,38,"updateAttendance"],[50,34,29,39,"workerId"],[50,42,29,47],[50,44,29,49,"dateISO"],[50,51,29,56],[50,53,29,58,"status"],[50,59,29,64],[50,61,29,66],[51,4,30,2],[51,10,30,8,"workers"],[51,17,30,15],[51,20,30,18],[51,26,30,24,"loadWorkers"],[51,37,30,35],[51,38,30,36],[51,39,30,37],[52,4,32,2],[52,8,32,6],[52,9,32,7,"workers"],[52,16,32,14],[52,17,32,15,"workerId"],[52,25,32,23],[52,26,32,24],[52,28,32,26],[53,6,33,4,"workers"],[53,13,33,11],[53,14,33,12,"workerId"],[53,22,33,20],[53,23,33,21],[53,26,33,24],[54,8,33,26,"attendance"],[54,18,33,36],[54,20,33,38],[55,6,33,41],[55,7,33,42],[56,4,34,2],[57,4,36,2],[57,8,36,6],[57,9,36,7,"workers"],[57,16,36,14],[57,17,36,15,"workerId"],[57,25,36,23],[57,26,36,24],[57,27,36,25,"attendance"],[57,37,36,35],[57,39,36,37],[58,6,37,4,"workers"],[58,13,37,11],[58,14,37,12,"workerId"],[58,22,37,20],[58,23,37,21],[58,24,37,22,"attendance"],[58,34,37,32],[58,37,37,35],[58,39,37,37],[59,4,38,2],[61,4,40,2],[62,4,41,2],[62,10,41,8,"existingIndex"],[62,23,41,21],[62,26,41,24,"workers"],[62,33,41,31],[62,34,41,32,"workerId"],[62,42,41,40],[62,43,41,41],[62,44,41,42,"attendance"],[62,54,41,52],[62,55,41,53,"findIndex"],[62,64,41,62],[62,65,41,63,"a"],[62,66,41,64],[62,70,41,68,"a"],[62,71,41,69],[62,72,41,70,"date"],[62,76,41,74],[62,81,41,79,"dateISO"],[62,88,41,86],[62,89,41,87],[63,4,43,2],[63,10,43,8,"record"],[63,16,43,14],[63,19,43,17],[64,6,44,4,"date"],[64,10,44,8],[64,12,44,10,"dateISO"],[64,19,44,17],[65,6,45,4,"status"],[65,12,45,10],[65,14,45,12,"status"],[65,20,45,18],[66,6,46,4,"markedAt"],[66,14,46,12],[66,16,46,14,"Date"],[66,20,46,18],[66,21,46,19,"now"],[66,24,46,22],[66,25,46,23],[67,4,47,2],[67,5,47,3],[68,4,49,2],[68,8,49,6,"existingIndex"],[68,21,49,19],[68,25,49,23],[68,26,49,24],[68,28,49,26],[69,6,50,4,"workers"],[69,13,50,11],[69,14,50,12,"workerId"],[69,22,50,20],[69,23,50,21],[69,24,50,22,"attendance"],[69,34,50,32],[69,35,50,33,"existingIndex"],[69,48,50,46],[69,49,50,47],[69,52,50,50,"record"],[69,58,50,56],[70,4,51,2],[70,5,51,3],[70,11,51,9],[71,6,52,4,"workers"],[71,13,52,11],[71,14,52,12,"workerId"],[71,22,52,20],[71,23,52,21],[71,24,52,22,"attendance"],[71,34,52,32],[71,35,52,33,"push"],[71,39,52,37],[71,40,52,38,"record"],[71,46,52,44],[71,47,52,45],[72,4,53,2],[73,4,55,2],[73,10,55,8,"saveWorkers"],[73,21,55,19],[73,22,55,20,"workers"],[73,29,55,27],[73,30,55,28],[74,4,56,2],[74,11,56,9,"workers"],[74,18,56,16],[74,19,56,17,"workerId"],[74,27,56,25],[74,28,56,26],[75,2,57,0],[76,2,59,7],[76,17,59,22,"updateSalary"],[76,29,59,34,"updateSalary"],[76,30,59,35,"workerId"],[76,38,59,43],[76,40,59,45,"dateISO"],[76,47,59,52],[76,49,59,54,"amount"],[76,55,59,60],[76,57,59,62],[77,4,60,2],[77,10,60,8,"workers"],[77,17,60,15],[77,20,60,18],[77,26,60,24,"loadWorkers"],[77,37,60,35],[77,38,60,36],[77,39,60,37],[78,4,62,2],[78,8,62,6],[78,9,62,7,"workers"],[78,16,62,14],[78,17,62,15,"workerId"],[78,25,62,23],[78,26,62,24],[78,28,62,26],[79,6,63,4,"workers"],[79,13,63,11],[79,14,63,12,"workerId"],[79,22,63,20],[79,23,63,21],[79,26,63,24],[80,8,63,26,"salary"],[80,14,63,32],[80,16,63,34],[81,6,63,37],[81,7,63,38],[82,4,64,2],[83,4,66,2],[83,8,66,6],[83,9,66,7,"workers"],[83,16,66,14],[83,17,66,15,"workerId"],[83,25,66,23],[83,26,66,24],[83,27,66,25,"salary"],[83,33,66,31],[83,35,66,33],[84,6,67,4,"workers"],[84,13,67,11],[84,14,67,12,"workerId"],[84,22,67,20],[84,23,67,21],[84,24,67,22,"salary"],[84,30,67,28],[84,33,67,31],[84,35,67,33],[85,4,68,2],[87,4,70,2],[88,4,71,2],[88,10,71,8,"existingIndex"],[88,23,71,21],[88,26,71,24,"workers"],[88,33,71,31],[88,34,71,32,"workerId"],[88,42,71,40],[88,43,71,41],[88,44,71,42,"salary"],[88,50,71,48],[88,51,71,49,"findIndex"],[88,60,71,58],[88,61,71,59,"s"],[88,62,71,60],[88,66,71,64,"s"],[88,67,71,65],[88,68,71,66,"date"],[88,72,71,70],[88,77,71,75,"dateISO"],[88,84,71,82],[88,85,71,83],[89,4,73,2],[89,10,73,8,"record"],[89,16,73,14],[89,19,73,17],[90,6,74,4,"date"],[90,10,74,8],[90,12,74,10,"dateISO"],[90,19,74,17],[91,6,75,4,"amount"],[91,12,75,10],[91,14,75,12,"amount"],[91,20,75,18],[92,6,76,4,"recordedAt"],[92,16,76,14],[92,18,76,16,"Date"],[92,22,76,20],[92,23,76,21,"now"],[92,26,76,24],[92,27,76,25],[93,4,77,2],[93,5,77,3],[94,4,79,2],[94,8,79,6,"existingIndex"],[94,21,79,19],[94,25,79,23],[94,26,79,24],[94,28,79,26],[95,6,80,4,"workers"],[95,13,80,11],[95,14,80,12,"workerId"],[95,22,80,20],[95,23,80,21],[95,24,80,22,"salary"],[95,30,80,28],[95,31,80,29,"existingIndex"],[95,44,80,42],[95,45,80,43],[95,48,80,46,"record"],[95,54,80,52],[96,4,81,2],[96,5,81,3],[96,11,81,9],[97,6,82,4,"workers"],[97,13,82,11],[97,14,82,12,"workerId"],[97,22,82,20],[97,23,82,21],[97,24,82,22,"salary"],[97,30,82,28],[97,31,82,29,"push"],[97,35,82,33],[97,36,82,34,"record"],[97,42,82,40],[97,43,82,41],[98,4,83,2],[99,4,85,2],[99,10,85,8,"saveWorkers"],[99,21,85,19],[99,22,85,20,"workers"],[99,29,85,27],[99,30,85,28],[100,4,86,2],[100,11,86,9,"workers"],[100,18,86,16],[100,19,86,17,"workerId"],[100,27,86,25],[100,28,86,26],[101,2,87,0],[102,2,89,7],[102,11,89,16,"isExpired"],[102,20,89,25,"isExpired"],[102,21,89,26,"markedAt"],[102,29,89,34],[102,31,89,36],[103,4,90,2],[103,8,90,6],[103,9,90,7,"markedAt"],[103,17,90,15],[103,19,90,17],[103,26,90,24],[103,31,90,29],[104,4,91,2],[104,10,91,8,"now"],[104,13,91,11],[104,16,91,14,"Date"],[104,20,91,18],[104,21,91,19,"now"],[104,24,91,22],[104,25,91,23],[104,26,91,24],[105,4,92,2],[105,10,92,8,"elapsed"],[105,17,92,15],[105,20,92,18,"now"],[105,23,92,21],[105,26,92,24,"markedAt"],[105,34,92,32],[106,4,93,2],[106,10,93,8,"twentyFourHours"],[106,25,93,23],[106,28,93,26],[106,30,93,28],[106,33,93,31],[106,35,93,33],[106,38,93,36],[106,40,93,38],[106,43,93,41],[106,47,93,45],[107,4,94,2],[107,11,94,9,"elapsed"],[107,18,94,16],[107,21,94,19,"twentyFourHours"],[107,36,94,34],[108,2,95,0],[109,2,97,7],[109,17,97,22,"getUserSubscription"],[109,36,97,41,"getUserSubscription"],[109,37,97,41],[109,39,97,44],[110,4,98,2],[110,8,98,6],[111,6,99,4],[111,12,99,10,"raw"],[111,15,99,13],[111,18,99,16],[111,24,99,22,"AsyncStorage"],[111,36,99,34],[111,37,99,34,"default"],[111,44,99,34],[111,45,99,35,"getItem"],[111,52,99,42],[111,53,99,43,"SUBSCRIPTION_KEY"],[111,69,99,59],[111,70,99,60],[112,6,100,4],[112,13,100,11,"raw"],[112,16,100,14],[112,19,100,17,"JSON"],[112,23,100,21],[112,24,100,22,"parse"],[112,29,100,27],[112,30,100,28,"raw"],[112,33,100,31],[112,34,100,32],[112,37,100,35],[113,8,100,37,"plan"],[113,12,100,41],[113,14,100,43],[113,21,100,50],[114,8,100,52,"status"],[114,14,100,58],[114,16,100,60],[115,6,100,69],[115,7,100,70],[116,4,101,2],[116,5,101,3],[116,6,101,4],[116,13,101,10,"e"],[116,14,101,11],[116,16,101,13],[117,6,102,4],[117,13,102,11],[118,8,102,13,"plan"],[118,12,102,17],[118,14,102,19],[118,21,102,26],[119,8,102,28,"status"],[119,14,102,34],[119,16,102,36],[120,6,102,45],[120,7,102,46],[121,4,103,2],[122,2,104,0],[123,2,106,7],[123,17,106,22,"setUserSubscription"],[123,36,106,41,"setUserSubscription"],[123,37,106,42,"subscription"],[123,49,106,54],[123,51,106,56],[124,4,107,2],[124,8,107,6],[125,6,108,4],[125,12,108,10,"AsyncStorage"],[125,24,108,22],[125,25,108,22,"default"],[125,32,108,22],[125,33,108,23,"setItem"],[125,40,108,30],[125,41,108,31,"SUBSCRIPTION_KEY"],[125,57,108,47],[125,59,108,49,"JSON"],[125,63,108,53],[125,64,108,54,"stringify"],[125,73,108,63],[125,74,108,64,"subscription"],[125,86,108,76],[125,87,108,77],[125,88,108,78],[126,6,109,4],[126,13,109,11],[126,17,109,15],[127,4,110,2],[127,5,110,3],[127,6,110,4],[127,13,110,10,"e"],[127,14,110,11],[127,16,110,13],[128,6,111,4,"console"],[128,13,111,11],[128,14,111,12,"error"],[128,19,111,17],[128,20,111,18],[128,48,111,46],[128,50,111,48,"e"],[128,51,111,49],[128,52,111,50],[129,6,112,4],[129,13,112,11],[129,18,112,16],[130,4,113,2],[131,2,114,0],[132,2,116,7],[132,8,116,13,"PLAN_LIMITS"],[132,19,116,24],[132,22,116,27],[133,4,117,2,"basic"],[133,9,117,7],[133,11,117,9],[134,6,118,4,"workers"],[134,13,118,11],[134,15,118,13],[134,16,118,14],[135,6,119,4,"sites"],[135,11,119,9],[135,13,119,11],[135,14,119,12],[136,6,120,4,"reports"],[136,13,120,11],[136,15,120,13],[136,17,120,15],[137,6,121,4,"features"],[137,14,121,12],[137,16,121,14],[137,17,121,15],[137,35,121,33],[138,4,122,2],[138,5,122,3],[139,4,123,2,"premium"],[139,11,123,9],[139,13,123,11],[140,6,124,4,"workers"],[140,13,124,11],[140,15,124,13],[140,17,124,15],[141,6,125,4,"sites"],[141,11,125,9],[141,13,125,11],[141,15,125,13],[142,6,126,4,"reports"],[142,13,126,11],[142,15,126,13],[142,18,126,16],[143,6,127,4,"features"],[143,14,127,12],[143,16,127,14],[143,17,127,15],[143,38,127,36],[143,40,127,38],[143,59,127,57],[143,61,127,59],[143,79,127,77],[144,4,128,2],[144,5,128,3],[145,4,129,2,"enterprise"],[145,14,129,12],[145,16,129,14],[146,6,130,4,"workers"],[146,13,130,11],[146,15,130,13],[146,18,130,16],[147,6,131,4,"sites"],[147,11,131,9],[147,13,131,11],[147,16,131,14],[148,6,132,4,"reports"],[148,13,132,11],[148,15,132,13],[148,19,132,17],[149,6,133,4,"features"],[149,14,133,12],[149,16,133,14],[149,17,133,15],[149,31,133,29],[150,4,134,2],[151,2,135,0],[151,3,135,1],[152,0,135,2],[152,3]],"functionMap":{"names":["<global>","loadWorkers","saveWorkers","updateAttendance","workers.workerId.attendance.findIndex$argument_0","updateSalary","workers.workerId.salary.findIndex$argument_0","isExpired","getUserSubscription","setUserSubscription"],"mappings":"AAA;OCQ;CDQ;OEE;CFQ;OGE;+DCY,uBD;CHgB;OKE;2DCY,uBD;CLgB;OOE;CPM;OQE;CRO;OSE;CTQ"},"hasCjsExports":false},"type":"js/module"}]}